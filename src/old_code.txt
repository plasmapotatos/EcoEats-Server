'''
    try:
        ingredients_text = request.json.get("ingredients_text")
        base64_image = request.json.get("base64_image")

        if not ingredients_text and not base64_image:
            return jsonify({"error": "No ingredient text or image provided."}), 400

        # Choose model based on input type
        model_name = "llava:13b" if base64_image else "llama3.2:latest"

        if base64_image and ingredients_text:
            # Both inputs present — prompt that includes text and image
            prompt = GENERATE_RECIPE_PROMPT.format(
                ingredients=(
                    f"Ingredients text: {ingredients_text}\n"
                    "Please also check the attached image for ingredients. "
                    "Create a proper ingredient list by combining both the image and text. "
                    "(Avoid duplicates as best as possible.)"
                )
            )
            inputs = [base64_image]
        elif base64_image:
            # Only image provided — placeholder text prompt + image input
            prompt = GENERATE_RECIPE_PROMPT.format(
                ingredients="Please check the attached image for ingredients."
            )
            inputs = [base64_image]
        else:
            # Only text provided — no image input
            prompt = GENERATE_RECIPE_PROMPT.format(ingredients=ingredients_text)
            inputs = []

        # Call Ollama with prompt + optional image(s)
        # recipe_response = call_ollama("llama3.2-vision:latest", prompt, inputs)['message']['content']
        response = call_ollama(model_name, prompt, inputs)
        print("Ollama raw response:", response)
        if "error" in response:
            return jsonify({"error": f"Ollama error: {response['error']}"}), 500
        if "message" not in response or "content" not in response["message"]:
            return jsonify(
                {"error": f"Unexpected Ollama response format: {response}"}
            ), 500

        recipe_response = response["message"]["content"]
        print("Generated Recipe:\n", recipe_response)

        # print("Generated Recipe:\n", recipe_response)

        # Generate image prompt and image from recipe text
        image_prompt = f"A realistic photo of the final dish prepared from the following recipe:\n{recipe_response}"
        image = pipe(image_prompt, num_inference_steps=10, guidance_scale=7.5).images[0]

        image.save("generated_dish.jpg")
        image_base64_out = pil_to_base64(image)

        return jsonify(
            {
                "recipe": recipe_response,
                "image_prompt": image_prompt,
                "image_base64": image_base64_out,
            }
        )
    except Exception as e:
        return jsonify({"error": f"Failed to generate recipe or image: {str(e)}"}), 500'''